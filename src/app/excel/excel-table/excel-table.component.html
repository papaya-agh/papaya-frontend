<p-toast></p-toast>
<app-menubar [userRole]="this.store.currentProject?.userRole" [currentProjectName]="this.store.currentProject?.name"></app-menubar>

<p-card header="Podsumowanie dostępności">
  <ng-template [ngIf]="isLoaded && declarableSprint">
    <div class="ui-g" id="availability-table">
      <div class="ui-g-8">
        <h5>
          Dostępność dla sprintu: <span class="bold">{{sprintStartDate | date: 'dd-MM-yyy'}}</span> - <span
          class="bold">{{sprintEndDate | date: 'dd-MM-yyyy'}}</span>
        </h5>
        <div *ngIf="sprintStateMap[declarableSprint.sprintState]"
             class="during">{{sprintStateMap[declarableSprint.sprintState]}}</div>
        <p-table [value]="workers">
          <ng-template pTemplate="header">
            <th>Lp.</th>
            <th>Osoba</th>
            <th>Zadeklarowane godziny</th>
            <th>Zaległe godziny</th>
            <th>Notatki</th>
          </ng-template>
          <ng-template pTemplate="body" let-worker let-i="rowIndex">
            <tr>
              <td>{{i + 1}}</td>
              <td [ngClass]="{'gray-user': worker.timeAvailable==''}">
                {{worker.name}}
              </td>
              <td>{{worker.timeAvailable}}</td>
              <td>{{worker.timeRemaining}}</td>
              <td>{{worker.notes}}</td>
            </tr>
          </ng-template>
        </p-table>
        <hr>
      </div>
    </div>
    <div id="availability-summary">
      <div class="ui-g">
        <div class="ui-g-2">
          <h5>Suma godzin</h5>
        </div>
        <div class="ui-g-1">
          <span>{{hoursSum}}</span>
        </div>
      </div>
      <div class="ui-g">
        <div class="ui-g-2">
          <h5>Aktualny współczynnik</h5>
        </div>
        <div class="ui-g-1">
          <span>{{actualRate}}</span>
        </div>
      </div>
    </div>
    <p-button *ngIf="declarableSprint.sprintState === 'FINISHED'"
              label="Zamknij sprint"
              (click)="closeSprint()"
              class="button">
    </p-button>
  </ng-template>
  <ng-template [ngIf]="isLoaded && !declarableSprint">
    <div>
      Obecnie nie ma żadnego sprintu, dla którego można wyświetlić dostępność
    </div>
  </ng-template>

</p-card>
